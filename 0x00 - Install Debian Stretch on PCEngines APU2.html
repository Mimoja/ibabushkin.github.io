<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Installing Debian on PCEngines APU2</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">body{margin:40px auto;max-width:700px;text-align:justify;line-height:1.6;font-size:16px;color:#444;padding:0 10px}h1,h2,h3{line-height:1.2}</style>
  <style type="text/css">img{margin: 10px; max-width:600px; border: 2px solid #d0d0d0;}</style>
  <style type="text/css">pre{border-radius: 10px;min-width:700px; margin-left: -10%;padding: 3%;padding-left: 7%; background: #002451; </style>

<link rel="stylesheet" href="/highlight/styles/tomorrow-night-blue.css">
<script src="/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

</head>
<body>
<h1>/sys/class/mimoja</h1>
<div id="header">
<h1 class="title">Installing Debian on PCEngines APU2</h1>
</div>
<hr />
<p><strong>TLDR: Add <code>console=ttyS0,115200n8</code> to kernel cmdline</strong></p>
<hr />
<h2 id="download-debian">Download Debian</h2>
<p>The PCEngines APU2 is a x86_64 CPU, meaning it can boot standart Desktop Linux distributions execpt for the ability to output graphics. Debian offers a graphical and a textbase installer. Therefor with the later we can install easily.</p>
<p>Debian Images can be found at <a href="https://www.debian.org/distrib/">debian.org</a>. Choose a version that suits you. &quot;small installation image&quot; is what is generally refered to as &quot;netinstall&quot;.</p>
<p>In this guide we go with &quot;debian-9.2.1-amd64-netinst.iso&quot;.</p>
<h2 id="preare-usb-stick">Preare USB Stick</h2>
<h2 id="windows">Windows</h2>
<p>Use <a href="https://sourceforge.net/projects/win32diskimager/">Win32DiskImager</a> to copy the Image to your stick.</p>
<h2 id="linux">Linux</h2>
<p>To copy the image to an install stick we use <code>dd</code> to copy it:</p>
<p><code>dd if=debian-9.2.1-amd64-netinst.iso of=/dev/sdX bs=4M</code></p>
<p>Replace sdX with your device. You can use <code>dmesg</code>shortly after pluggin in to figure it out.</p>
<h2 id="establish-serial-connection">Establish serial connection</h2>
<p>Plug your USB-&gt;RS232 adapter into both machines. Based on your preferences you can use any tool you want.</p>
<h3 id="windows-1">Windows</h3>
<p>Use <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">putty</a> to establish a serial connection with 115200 Baud (Speed) to <strong>COMX</strong> where <strong>X</strong> refers to your adapter.</p>
<h3 id="linux-1">Linux</h3>
<p>We will cover two <strong>alternative</strong> tools here:</p>
<h4 id="busybox-microcom">busybox microcom</h4>
<p>Run as <strong>root</strong> or use <strong>sudo</strong>:</p>
<p><code>busybox microcom /dev/ttyUSB0 -s115200</code></p>
<h4 id="screen">screen</h4>
<p>Run as <strong>root</strong> or use <strong>sudo</strong>:</p>
<p><code>screen /dev/ttyUSB0 115200</code></p>
<h2 id="booting-the-apu2">Booting the APU2</h2>
<p>Connect the USB stick, power and monitor the serial output. You should see something like this:</p>
<p>Press F10, choose your USB stick and hit enter.</p>
<div class="figure">
<img src="tech/0x00/bootup.png" title="bootup" />

</div>
<p>In the now opening boot menu we need to modify the kernel cmdline. Choose <code>Install</code> and hit <code>TAB</code>. Now add <strong><code>console=ttyS0,115200n8</code></strong> after the <code>quiet</code>. Hit enter to boot the system.</p>
<div class="figure">
<img src="tech/0x00/bootup_menu.png" title="menu" />

</div>
<h2 id="post-boot">Post Boot</h2>
<p>Follow the installation process and dont forget to enable <strong>SSH-Server</strong> if you want to control your device remotly after installation.</p>
<div class="figure">
<img src="tech/0x00/installer.png" title="installer" />

</div>
<p>The Debian Stretch Installer will copy the kernel boot parameter so you should end up with a system outputting to serial after installation finished.</p>
<div class="figure">
<img src="tech/0x00/installing.png" title="installing" />

</div>
<p>Reboot and enjoy!</p>
<br>
<a href="index.html">home</a>
</body>
</html>
